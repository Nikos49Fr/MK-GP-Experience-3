<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - MK GP Experience 3</title>
    <link rel="stylesheet" href="./../css/admin.css">
</head>
<body>
    <header class="admin-header">
        <h1>Console Admin - MK GP Experience 3</h1>
        <nav>
            <a href="./../index.html" id="index-link" class="btn-link">Retour</a>
            <button id="logout-btn" class="logout-btn" hidden>Logout</button>
        </nav>
    </header>

    <main class="admin-main">
        <!-- RESET (live + context en RTDB) -->
        <section class="admin-section" id="reset-section">
            <h2>Reset (RTDB)</h2>
            <div class="table-wrap">
                <table class="admin-table" id="reset-table" aria-describedby="reset-help">
                    <thead>
                        <tr>
                            <th></th>
                            <th colspan="8" class="group">MK8</th>
                            <th colspan="14" class="group">MKW</th>
                        </tr>
                        <tr>
                            <th></th>
                            <!-- MK8: 8 courses -->
                            <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th>
                            <!-- MKW: 14 "courses" (1..6, S, 7..12, SF) -->
                            <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>S</th>
                            <th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>SF</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Choix course courante (simulation) -->
                        <tr>
                            <td>Course courante (simulation)</td>
                            <!-- MK8 radios -->
                            <td><input type="radio" name="sim-current" data-game="MK8" data-race="1"></td>
                            <td><input type="radio" name="sim-current" data-game="MK8" data-race="2"></td>
                            <td><input type="radio" name="sim-current" data-game="MK8" data-race="3"></td>
                            <td><input type="radio" name="sim-current" data-game="MK8" data-race="4"></td>
                            <td><input type="radio" name="sim-current" data-game="MK8" data-race="5"></td>
                            <td><input type="radio" name="sim-current" data-game="MK8" data-race="6"></td>
                            <td><input type="radio" name="sim-current" data-game="MK8" data-race="7"></td>
                            <td><input type="radio" name="sim-current" data-game="MK8" data-race="8"></td>
                            <!-- MKW radios -->
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="1"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="2"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="3"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="4"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="5"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="6"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="S"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="7"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="8"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="9"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="10"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="11"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="12"></td>
                            <td><input type="radio" name="sim-current" data-game="MKW" data-race="SF"></td>
                        </tr>

                        <!-- Effacement course à course (exécution immédiate) -->
                        <tr>
                            <td>Effacer la course</td>
                            <!-- MK8 clear -->
                            <td><button class="btn danger" data-action="clear" data-game="MK8" data-race="1">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MK8" data-race="2">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MK8" data-race="3">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MK8" data-race="4">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MK8" data-race="5">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MK8" data-race="6">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MK8" data-race="7">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MK8" data-race="8">Effacer</button></td>
                            <!-- MKW clear -->
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="1">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="2">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="3">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="4">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="5">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="6">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="S">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="7">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="8">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="9">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="10">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="11">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="12">Effacer</button></td>
                            <td><button class="btn danger" data-action="clear" data-game="MKW" data-race="SF">Effacer</button></td>
                        </tr>

                        <!-- Reset général -->
                        <tr>
                            <td colspan="23" class="cell-actions">
                                <button class="btn danger" id="reset-all-btn">RESET GÉNÉRAL — effacer toutes les courses (live + context)</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p id="reset-help" class="table-help">
                    Le reset n’affecte pas <code>meta</code>. Les boutons “Effacer” agissent immédiatement sans confirmation.
                    Le “RESET GÉNÉRAL” demande une confirmation.
                </p>
            </div>
        </section>
        
        <!-- MATRICE DES POINTS -->
        <section class="admin-section" id="points-section">
            <h2>Matrices de points</h2>

            <div class="table-wrap">
                <div class="points-controls">
                    <button class="btn icon warning" id="points-edit-btn" title="Éditer">Éditer</button>
                    <button class="btn icon success" id="points-save-btn" title="Sauvegarder" hidden>Sauvegarder</button>
                    <button class="btn icon danger" id="points-cancel-btn" title="Annuler" hidden>Annuler</button>
                </div>

                <table class="admin-table" id="points-grid-table" aria-describedby="points-grid-help">
                    <thead>
                        <tr>
                            <th></th>
                            <!-- Colonnes rangs 1..24, rendues par JS -->
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 4 lignes rendues par JS :
                            - MK8 course (rangs 1..12 actifs, 13..24 grisés)
                            - MKW course (1..24)
                            - MKW Survie 1 (S1)
                            - MKW Survie finale (S2)
                        -->
                    </tbody>
                </table>
                <p id="points-grid-help" class="table-help">
                    En-têtes colonnes = classement (1 à 24). Lignes = MK8 course, MKW course, MKW Survie 1 (S1), MKW Survie finale (S2).
                </p>
            </div>
        </section>

        <!-- ÉCURIES / TEAMS -->
        <section id="section-teams" class="admin-section">
            <h2>Écuries</h2>

            <div class="table-wrap">

<table class="admin-table" id="teams-table" aria-describedby="teams-help">
    <thead>
    <tr>
        <th>Ordre</th>
        <th>Nom</th>
        <th>Tag</th>
        <th>Secrète</th>
        <th>Couleur 1</th>
        <th>Couleur 2</th>
        <th>Logo (URL)</th>
        <th class="col-actions">Actions</th>
    </tr>
    </thead>

    <tbody>
        <!-- Ligne d'ajout -->
        <tr class="row-add" data-mode="create">
            <td><input type="number" id="team-order-new" placeholder="1" min="0" step="1" inputmode="numeric" autocomplete="off"></td>
            <td><input type="text" id="team-name-new" placeholder="MooMoo Meadows Milk" autocomplete="off"></td>
            <td><input type="text" id="team-tag-new" placeholder="MMM" maxlength="6" autocomplete="off"></td>
            <td class="cell-center">
                <label class="switch">
                    <input type="checkbox" id="team-secret-new">
                    <span aria-hidden="true"></span>
                </label>
            </td>
            <td><input type="text" id="team-color1-new" placeholder="#f6b87f" pattern="^#([A-Fa-f0-9]{3}|[A-Fa-f0-9]{6})$" autocomplete="off"></td>
            <td><input type="text" id="team-color2-new" placeholder="#fccc88" pattern="^#([A-Fa-f0-9]{3}|[A-Fa-f0-9]{6})$" autocomplete="off"></td>
            <td><input type="text" id="team-logo-new" placeholder="ex: team-1/logo.png" autocomplete="off"></td>
            <td class="cell-actions">
                <button class="btn icon success" id="team-add-btn" title="Ajouter l'écurie" aria-label="Ajouter">+</button>
            </td>
        </tr>


        <!-- Lignes existantes rendues par JS -->
    </tbody>
</table>

                <p id="teams-help" class="table-help">La première ligne sert à créer une écurie. Les lignes suivantes pourront être modifiées ou supprimées.</p>
            </div>
        </section>

        <!-- PILOTES -->
        <section id="section-pilots" class="admin-section">
            <h2>Pilotes</h2>

            <div class="table-wrap">
<table class="admin-table" id="pilots-table" aria-describedby="pilots-help">
    <thead>
        <tr>
            <th>Ordre</th>
            <th>Nom</th>
            <th>Tag</th>
            <th>Numéro</th>
            <th>Jeu</th>
            <th>Streamer</th>
            <th>Twitch (URL)</th>
            <th>Photo (URL)</th>
            <th>Écurie</th>
            <th>Écurie secrète</th>
            <th>Mode traître</th>
            <th class="col-actions">Actions</th>
        </tr>
    </thead>


    <tbody>
        <!-- Ligne d'ajout -->
    <tr class="row-add" data-mode="create">
        <td><input type="number" id="pilot-order-new" placeholder="1" min="0" step="1" inputmode="numeric" autocomplete="off"></td>
        <td><input type="text" id="pilot-name-new" placeholder="ENSURI" autocomplete="off"></td>
        <td><input type="text" id="pilot-tag-new" placeholder="ENS" maxlength="6" autocomplete="off"></td>
        <td><input type="text" id="pilot-num-new" placeholder="00 à 99" maxlength="2" inputmode="numeric" autocomplete="off"></td>
        <td>
            <select id="pilot-game-new">
            <option value="MK8">MK8</option>
            <option value="MKW">MKW</option>
            </select>
        </td>
        <td class="cell-center">
            <label class="switch">
            <input type="checkbox" id="pilot-streamer-new">
            <span aria-hidden="true"></span>
            </label>
        </td>
        <td><input type="text" id="pilot-twitch-new" placeholder="EnsuriLive" autocomplete="off"></td>
        <td><input type="text" id="pilot-photo-new" placeholder="ex: pilots/ENS.png" autocomplete="off"></td>
        <td>
            <select id="pilot-team-new"><option value="">—</option></select>
        </td>
        <td>
            <select id="pilot-secret-team-new"><option value="">—</option></select>
        </td>
        <td>
            <select id="pilot-traitor-mode-new">
            <option value="">—</option>
            <option value="double">Double (MK8)</option>
            <option value="transfer">Transfert (MKW)</option>
            </select>
        </td>
        <td class="cell-actions">
            <button class="btn icon success" id="pilot-add-btn" title="Ajouter le pilote" aria-label="Ajouter">+</button>
        </td>
    </tr>


        <!-- Lignes existantes rendues par JS -->
    </tbody>
</table>
                <p id="pilots-help" class="table-help">La première ligne sert à créer un pilote. Les champs non renseignés peuvent être complétés plus tard.</p>
            </div>
        </section>
    </main>


    <!-- Auth guard -->
    <script type="module" src="./../js/firebase-config.js?v=3"></script>
    <script type="module" src="./../js/admin-auth.js"></script>
    <script type="module" src="./../js/admin.js"></script>
</body>
</html>
